■概要
Zoomミーティングのチャット欄の保存されたログファイルを読み込み、形態素N-gram・ワードクラウド・共起ネットワークおよび発言数推移のグラフを出力します。
出力には自然言語の可視化ライブラリ「nlplot」(https://www.takapy.work/entry/2020/05/17/192947)を使用しています。


■動作環境
Windows11


■導入方法(Python版)
Python3.10(※)をインストール、あるいはvirtualenvなどで環境を用意し、「requirements.txt」で示したパッケージをPyPIからインストールしてください。
※2023年10月現在、nlplotがPython3.11以降に非対応のためPython3.10推奨


■起動方法(Python版)
「main.py」が存在するディレクトリで上記パッケージをインストールしたPythonを起動し、「main.py」を実行してください。


■使用方法
○読み込み画面
起動時の画面です。Zoomから取得したログや処理済ファイルを中央の四角で囲まれたエリアにドラッグ&ドロップするか、「参照」ボタンから選ぶことで読み込み対象となります。

2023/8/8現在のZoomの取得方式を用いております。取得日時やミーティング名が記されたフォルダの下に「meeting_saved_chat.txt」が置かれている方式を想定しているため、この仕様が変更になると正常に動作しなくなる可能性があります。

ドラッグ&ドロップする際のログは、txtファイルあるいはそのすぐ上のフォルダのどちらでも読み込ませられます。複数選択することで一括での読み込みも可能です。

読み込み対象となったファイルの一覧はウィンドウ右側に表示されます。Zoomから取得したままのフォルダ名であれば、そこから日付とミーティング名を自動取得します。フォルダ名が変わっていた場合は日付やミーティング名が空欄となっていることがあるので、その場合は手入力が可能です。また取得日と実施日が異なる場合も手入力で修正してください。

処理済ファイルは設定された保存先に保存されたjsonファイルを同様に読み込み対象として指定してください。

読み込み対象を一覧から削除するには「×」ボタンを押下してください。
「参照」ボタンではじめに開かれるフォルダは設定から変更できます。

「読込実行」ボタンを押下すると一覧にあるファイルの読み込みと処理が開始されます。


○単語全体の分析
読込実行後、左側の領域でできることです。
この画面では、以下のものが出力できます。

●形態素N-gram(,uni-gram)
隣り合った形態素n個の組み合わせが出現した回数を横向き棒グラフで表したものを形態素N-gramといいます。
このうちn=1のものをuni-gramといい、別途ボタンで出力できます。
n数は1~5で設定できますが、3以下で見るのが一般的です。

●wordcloud
単語の出現数に応じて、多いものは大きい文字で、少ないものは小さい文字で表示される画像を出力します。
wordcloudのみhtmlではなく画像データとして出力されるので、保存も画像データとなります。デフォルトはpngですが、設定で変更できます。

●共起ネットワーク
同時に発言された単語同士を集計し、線で繋いだ図を出力します。


以下は、画面内の各項目の説明です。

・集計範囲(全グラフ)
集計処理対象とするチャットの日付の範囲です。空白を選択すると左側は最古の日付、右側は最新の日付と自動的に認識されます。

・品詞の選択(uni-gram, wordcloud, 共起ネットワーク)
集計処理対象とする品詞の選択をします。品詞の分類はUniversal Dependencies(UD)のPOSタグを用いています。
名詞・代名詞(NOUN/PRON), 固有名詞(PROPN), 動詞(VERB), 形容詞(ADJ), 副詞(ADV), 接続詞(CONJ/SCONJ)を集計処理対象に設定でき、チェックボタンでON/OFFできます。
uni-gramを除く形態素N-gramでは、形態素の連続性が重要なため全ての品詞を分析に含めます。
設定で初期値を変更できます。

・ストップワードの設定(全グラフ)
出現回数が多すぎて、または少なすぎてノイズになる頻出単語を集計処理対象から除外します。
例えば、上位頻出に3を入れた場合は出現回数が上位3位までの単語を除外し、下位頻出に10を入れた場合は出現回数が10回以下の単語を除外します。
設定で初期値を変更できます。

・その他除外する単語(全グラフ)
その他ノイズになると判断した単語を直接入力して除外できます。記号は認識されない場合があります。
複数指定する場合はスペース(半角・全角どちらも可)で区切ることで別個の単語として指定できます。
設定で初期設定を変更できます。

・隣接形態素数(形態素N-gram)
形態素N-gramで隣接する形態素のn数です。
設定で初期値を変更できます。

・最少エッジ数(共起ネットワーク)
共起ネットワークに表示するノードのフィルターです。この数値より低いエッジ数を持つノードは表示されなくなります。
設定で初期値を変更できます。

・共起ネットワークサイズ(共起ネットワーク)
設定項目ではなく現設定での共起ネットワークの大きさを表示する場所です。
一般的にnode_sizeが100前後であれば見やすいネットワークになるとされています。

・共起ネットワーク再計算
上記設定を変更した場合「共起ネットワークサイズ」の表示を更新します。
各種出力の前にも再計算処理が入るため、毎回このボタンを押下する必要はありません。

・解析結果テーブルを表示
現在の設定で抽出されている単語や発言者名、元の発言テキストなどの情報を別ウィンドウで表示します。

・htmlファイル(wordcloudは画像)を保存
この項目にチェックを入れて各種出力をすると、出力結果を既定のフォルダに保存します。
設定で保存先を変更できます。

・uni-gramを出力
uni-gramをブラウザで出力します。

・形態素N-gramを出力
形態素N-gramをブラウザで出力します。

・wordcloudを出力
wordcloudを別ウィンドウで出力します。

・共起ネットワークを出力
共起ネットワークをブラウザで出力します。


○参加者の発言数分析
読込実行後、右側の領域でできることです。
この画面では、以下のものが出力できます。

●発言数推移(日毎・累計)
発言者名からその日のチャットで発言した参加者それぞれについて発言回数を集計し、横軸を日付、縦軸を回数とした折れ線グラフで出力します。
「発言数推移を出力」で日毎の発言数の推移を、「合計発言数推移を出力」で集計範囲内でその日までの累計発言数の推移を出力します。


以下は、画面内の各項目の説明です。

・集計範囲
集計処理対象とするチャットの日付の範囲です。空白を選択すると左側は最古の日付、右側は最新の日付と自動的に認識されます。

・集計する対象を選択/全て選択/全て解除
集計処理対象とする発言者を選択できます。ここで選択されていない発言者は集計から除外されます。
「全て選択」「全て解除」ボタンでリストボックスの一括選択と解除ができます。

・詳細
集計対象のリストボックスのカスタマイズ画面を別ウィンドウで開きます。
同一人物の表記揺れを統一したり、プライバシー保護のために表示名を変更したりする際に使用できます。
枠内のプルダウンボックスから対象となる発言者を選択し、枠線上のテキストボックスに表示名を設定します。
枠線上の「+」「×」ボタンでユニット単位の増減、枠内の「+」「×」ボタンでプルダウンボックスの増減ができます。
「OK」で設定を決定したのち、「集計する対象を選択」の内容が更新されていることを確認し改めて選択してください。

・他の分析にもこの設定を適用
「単語全体の分析」の各分析(uni-gram等)を出力する際にも、「集計する対象を選択」で除外した発言者の発言を含めずに集計するようになります。

・解析結果テーブルを表示(日毎/累計)
集計処理対象の各日付の発言数または累計発言数を表にして別ウィンドウで表示します。

・htmlファイルを保存
この項目にチェックを入れて各種出力をすると、出力結果を既定のフォルダに保存します。
設定で保存先を変更できます。

・発言数推移を出力
発言数推移グラフ(日毎)をブラウザで出力します。

・合計発言数推移を出力
発言数推移グラフ(累計)をブラウザで出力します。


○メニューバー
[ファイル]メニュー
・ミーティング名変更
現在処理中のミーティング名を表示および変更できます。ミーティング名は保存ファイル名などに使用されます。

・読み込み画面に戻る
読み込み画面に戻ります。アプリケーションを終了し再起動するのと同等の処理になるため、現在の作業を再開する場合は保存してください。

・設定
設定画面を別ウィンドウで開きます。

・終了
作業中のデータを保存するか確認ののち、アプリケーションを終了します。
設定から自動保存の設定ができます。

[ヘルプ]メニュー
・マニュアル
使用方法の説明(この文章)を別ウィンドウで表示します。


○設定画面
メニューバーから「[ファイル] → [設定]」を開くことで表示される画面です。

「OK」ボタンで変更を適用し画面を閉じます。
「キャンセル」ボタンあるいはウィンドウの「×」ボタンで変更を破棄し画面を閉じます。
「適用」ボタンで画面を開いたまま現在の変更を適用します。

いずれのタブも「このタブを初期化」ボタンでデフォルトの値に変更できます。
このときのデフォルト値はインストール時の値であり、設定画面を開いた時点での値とは異なることに注意してください。


以下は各タブの説明です。

[読込/保存]タブ
・読み込みログファイル選択ダイアログの初期表示フォルダ
読み込み画面で「参照」ボタンを押下した際のダイアログではじめに表示されるフォルダです。
デフォルトでは下記データフレームの自動保存先と同じフォルダに設定されています。

・終了時のデータフレーム自動保存先フォルダ
読み込み処理後に終了する際、自動保存が行われたときのjsonファイルの保存先フォルダです。
デフォルトではexeファイルのあるフォルダにある「1_saved_files」内の「df_files」に設定されています。

・グラフ・画像の保存先フォルダ
「htmlファイルを保存」にチェックを入れて可視化を実行した際にファイルが保存されるフォルダです。
デフォルトではexeファイルのあるフォルダにある「1_saved_files」内の「figures」に設定されています。

・処理済みデータフレーム読み込み時、前回の処理設定を自動で引き継ぐ
読み込み画面で処理済みのデータフレームを読み込んだ際、品詞選択やストップワード、集計対象発言者などの設定を保存し自動設定します。
複数のデータフレームを読み込んだ際は、チャット数が多いものが優先されます。
デフォルト値はONです。

・未処理ログ読み込み時、前回の処理設定をミーティング名から判断して引き継ぐ
読み込み画面で処理済みのデータフレームを読み込まず、ログファイルのみで読込実行をした際、ミーティング名から以前に同名のものが保存されているかを判断し、品詞選択などを自動設定します。
複数のミーティング名でログファイルを読み込んだ際は、合計チャット数が多いものが優先されます。
デフォルト値はONです。

・終了時に解析データを自動保存する
読込実行後、アプリケーション終了時にデータフレームの保存確認をせず自動的に処理結果を保存します。
デフォルト値はOFFです。


[グラフ全般]タブ
・グラフタイトル・ラベルをブラウザ上で編集する
wordcloud以外のグラフをブラウザで表示した際、グラフタイトルやラベルを編集できるようにします。
デフォルト値はONです。

・凡例を移動可能にする
凡例のあるグラフをブラウザで表示した際、凡例をドラッグで移動できるようにします。
デフォルト値はOFFです。

・マウスホイールでグラフを拡大・縮小する
wordcloud以外のグラフをブラウザで表示した際、マウスホイールで拡大や縮小を操作できるようにします。
デフォルト値はOFFです。

[単語全体の分析]タブ
・ワードクラウドを画像保存するときのファイル形式
「htmlファイル(wordcloudは画像)を保存」にチェックを入れてwordcloudを出力した際に保存されるファイルフォーマットです。
デフォルトではpngに設定されています。

・uni-gramのグラフタイトル
uni-gramを出力した際のグラフタイトルです。
デフォルトでは「uni-gram」に設定されています。

・uni-gramのX軸ラベル
uni-gramを出力した際のX軸ラベルです。
デフォルトでは「word_count」に設定されています。

・uni-gramのY軸ラベル
uni-gramを出力した際のY軸ラベルです。
デフォルトでは「word」に設定されています。

・形態素N-gramのグラフタイトル
形態素N-gramを出力した際のグラフタイトルです。
デフォルトでは「N-gram」に設定されています。

・形態素N-gramのX軸ラベル
形態素N-gramを出力した際のX軸ラベルです。
デフォルトでは「word_count」に設定されています。

・形態素N-gramのY軸ラベル
形態素N-gramを出力した際のY軸ラベルです。
デフォルトでは「word」に設定されています。

・共起ネットワークのタイトル
共起ネットワークを出力した際の図タイトルです。
デフォルトでは「Co-occurrence network」に設定されています。


[参加者の発言数分析]タブ
・発言数推移のグラフタイトル
日毎の発言数推移を出力した際のグラフタイトルです。
デフォルトでは「number of comments」に設定されています。

・発言数推移のX軸ラベル
日毎の発言数推移を出力した際のX軸ラベルです。
デフォルトでは「date」に設定されています。

・発言数推移のY軸ラベル
日毎の発言数推移を出力した際のY軸ラベルです。
デフォルトでは「number of comments」に設定されています。

・発言数推移の凡例タイトル
日毎の発言数推移を出力した際の凡例タイトルです。
デフォルトでは「members」に設定されています。

・発言数推移のグラフテーマ
日毎の発言数推移を出力した際のグラフテーマです。グラフテーマはplotly.io.templatesで用意されているテンプレートから選択できます。
デフォルトでは「plotly_white」に設定されています。

・発言数推移(累計)のグラフタイトル
累計の発言数推移を出力した際のグラフタイトルです。
デフォルトでは「number of comments(total)」に設定されています。

・発言数推移(累計)のX軸ラベル
累計の発言数推移を出力した際のX軸ラベルです。
デフォルトでは「date」に設定されています。

・発言数推移(累計)のY軸ラベル
累計の発言数推移を出力した際のY軸ラベルです。
デフォルトでは「number of comments(total)」に設定されています。

・発言数推移(累計)の凡例タイトル
累計の発言数推移を出力した際の凡例タイトルです。
デフォルトでは「members」に設定されています。

・発言数推移(累計)のグラフテーマ
累計の発言数推移を出力した際のグラフテーマです。グラフテーマはplotly.io.templatesで用意されているテンプレートから選択できます。
デフォルトでは「plotly_white」に設定されています。


[初期処理]タブ
過去の処理からの自動設定がOFFになっている場合や初めての処理となるミーティング名が設定された場合に単語全体の分析画面で設定される初期設定をカスタマイズできます。

・品詞の選択
デフォルトでは「名詞・代名詞」「固有名詞」のみがONに設定されています。

・ストップワード:上位頻出(単語数)
デフォルト値は0です。

・ストップワード:下位頻出(回数)
デフォルト値は0です。

・その他除外する単語(スペース区切り)
デフォルトでは空欄に設定されています。

・最少エッジ数(共起ネットワーク用)
デフォルトでは0に設定されています。


■制作日
2023/07/28


■制作環境
Python 3.10.9
    nlplot 1.6.0
    tkinterdnd2 0.3.0
    pandas 1.5.3
    matplotlib 3.7.1
    plotly 5.13.1
    ja_ginza 5.1.2
    spacy 3.4.4
    pyinstaller 5.13.0
Inno Setup 6.2.2


■履歴
2023/07/28 ver1.0
2023/08/15 ver1.1 read_me作成、マニュアル画面追加、表示を一部修正
2023/10/31 ver1.2 read_meを一部改訂、ログのシステムメッセージ言語に対応する修正を追加、コンフィグの保存に例外処理を追加
